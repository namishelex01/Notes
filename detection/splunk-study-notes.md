# Splunk queries

Active Directory User Backdoors

Activity Related to NTDS.dit Domain Hash Retrieval

Addition of SID History to Active Directory Object

Admin User Remote Logon

Apache Segmentation Fault

APT User Agent

Backup Catalog Deleted

Bitsadmin Download

Buffer Overflow Attempts

cmdkey Cached Credentials Recon

Command Line Execution with suspicious URL and AppData Strings

Detection MavInject32.exe execution

Detects malware AcroRD32.exe execution process

Detects Suspicious Commands on Linux systems

DHCP Callout DLL installation

DHCP Server Error Failed Loading the CallOut DLL

DHCP Server Loaded the CallOut DLL

Disabling Windows Event Auditing

DiskShadow and Vshadow launch detection

Django framework exceptions

DNS Server Error Failed Loading the ServerLevelPluginDLL

DNS ServerLevelPluginDll Install

Download EXE from Suspicious TLD

Download from Suspicious Dyndns Hosts

Download from Suspicious TLD

Droppers exploiting CVE-2017-11882

DualToy Trojan Detection

Elise Backdoor

Empty User Agent

Enabled User Right in AD to Control User Objects

Enabling RDP remotely using PsExec

Equation Group C2 Communication

Equation Group Indicators

Eventlog Cleared

Eventlog Cleared

Executable used by PlugX in Uncommon Location

Executable used by PlugX in Uncommon Location

Executables Started in Suspicious Folder

Execution in Non-Executable Folder

Execution in Webserver Root Folder

Exploit for CVE-2015-1641

Exploit for CVE-2017-0261

Exploit for CVE-2017-8759

Exploit Framework User Agent
Fireball Archer Install

Flash Player Update from Suspicious Location

FlawedAmmyy RAT Detection

FlawedAmmyy RAT Detection (Proxy)

Hack Tool User Agent

Hacktool Use

HIDDEN COBRA RAT/Worm

Interactive Logon to Server Systems

InvisiMole SpyWare Detector

Java Running with Remote Debugging

Kerberos Manipulation

klist purge

List RDP Connections History Unload

Locky Ransomware C2/Download/Payment Communication

Lojack Double-Agent Communication

LokiBot Trojan Detector

Malicious Named Pipe

Malicious PowerShell Commandlets

Malicious PowerShell Commandlets

Malicious Service Install

Malicious Service Installations

Malware Shellcode in Verclsid Target Process

Malware User Agent

Microsoft Binary Github Communication

Microsoft Malware Protection Engine Crash

Microsoft Office Product Spawning Windows Shell

Microsoft Outlook Spawning Windows Shell

Mimikatz Detection LSASS Access

Mimikatz In-Memory

Mimikatz Use

MSHTA Spawning Windows Shell

MuddyWater APT

Multiple Failed Logins with Different Accounts from Single Source System

Multiple Failed Logins with Different Accounts from Single Source System

Multiple Modsecurity Blocks

Multiple suspicious Response Codes caused by Single Client

Net.exe Execution

Network Scans

New RUN Key Pointing to Suspicious Folder

NotPetya Ransomware Activity

Office Macro Starts Cmd

OrangeWorm C2 Communication

OrangeWorm Kwampirs service installation

Pandemic Registry Key

Pass the Hash Activity

Password Change on Directory Service Restore Mode (DSRM) Account

Password Dumper Activity on LSASS

Password Dumper Remote Thread in LSASS

Ping Hex IP

Possible Remote Password Change Through SAMR

PowerShell called from an Executable Version Mismatch

PowerShell Credential Prompt

PowerShell Downgrade Attack

PowerShell Download from URL

PowerShell Network Connections

PowerShell PSAttack 

Processes created by MMC

Program Executions in Suspicious Folders

Ps.exe Renamed SysInternals Tool

PsExec Service Start

PsExec Tool Execution

Python SQL Exceptions

QuarksPwDump Dump File

Rare Scheduled Task Creations

Rare Schtasks Creations

Rare Service Installs

Reconnaissance Activity

Registry Persistence Mechanisms

Regsvr32 Anomaly

Relevant Anti-Virus Event

Relevant ClamAV Message

Ruby on Rails framework exceptions

Rundll32 Internet Connection

SAM Dump to AppData

Scheduled Task Creation

Secure Deletion with Sdelete

Security Eventlog Cleared

Shells Spawned by Web Servers

Shellshock Expression

smbexec.py Service Installation

Sofacy - APT C2 Domain Communication

Spring framework exceptions

SquiblyTwo

StalinLocker Detector

Sticky Key Like Backdoor Usage

StoneDrill Service Install

Successful Overpass the Hash Attempt

Suspicious Activity in Shell Commands

Suspicious Certutil Command

Suspicious Control Panel DLL Load

Suspicious Driver Load from Temp

Suspicious Failed Logon Reasons

Suspicious Kerberos RC4 Ticket Encryption

Suspicious Log Entries

Suspicious Named Error

Suspicious PowerShell Download

Suspicious PowerShell Invocation based on Parent Process

Suspicious PowerShell Invocations

Suspicious PowerShell Invocations - Generic

Suspicious PowerShell Parameter Substring

Suspicious PowerShell ZIPing activity

Suspicious Program Location with Network Connections

Suspicious Reconnaissance Activity

Suspicious SQL Error Messages

Suspicious SSHD Error

Suspicious Svchost Process

Suspicious TSCON Start

Suspicious Typical Malware Back Connect Ports

Suspicious User Agent

Suspicious VSFTPD Error Messages

Suspicious WMI execution

System File Execution Location Anomaly

Taskmgr as LOCAL_SYSTEM

Taskmgr as Parent

Turla Group Named Pipes

Turla Service Install

UAC Bypass via Event Viewer

UAC Bypass via sdclt

USB Device Plugged

User Added to Local Administrators

VPNFilter Destructive Malware detection

VPNFilter Destructive Malware detection

VPNFilter Malware Detector (Hashes)

WannaCry Ransomware via Sysmon

WCE wceaux.dll Access

Weak Encryption Enabled and Kerberoast

Webshell Detection by Keyword

Webshell Detection With Command Line Keywords

Windows PowerShell User Agent

Windows PowerShell WebDav User Agent

Windows Shell Spawning Suspicious Program

WMI Persistence

WMI Persistence - Command Line Event Consumer

WMI Persistence - Script Event Consumer File Write

WMIExec VBS Script

WScript or CScript Dropper

WSF/JSE/JS/VBA/VBE File Execution

YiSpecter Malware Detection

ZxShell Malware

